<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5-Player Aerospace Ethics Jeopardy</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #060CE9, #001572);
            color: white;
            min-height: 100vh;
            overflow-x: auto;
        }

        /* Audio Controls */
        .audio-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 10px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .audio-btn {
            background: #FFCC00;
            color: black;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .audio-btn:hover {
            background: #FFD700;
            transform: scale(1.05);
        }

        .audio-btn.muted {
            background: #666;
            color: white;
        }

        .volume-slider {
            width: 80px;
            height: 5px;
            background: #333;
            border-radius: 5px;
            outline: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 15px;
            height: 15px;
            background: #FFCC00;
            border-radius: 50%;
            cursor: pointer;
        }

        .pulse-animation {
            animation: pulse 0.6s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .correct-flash {
            animation: correctFlash 1s ease-in-out;
        }

        @keyframes correctFlash {
            0% { background-color: rgba(0,255,0,0); }
            50% { background-color: rgba(0,255,0,0.3); }
            100% { background-color: rgba(0,255,0,0); }
        }

        .incorrect-flash {
            animation: incorrectFlash 1s ease-in-out;
        }

        @keyframes incorrectFlash {
            0% { background-color: rgba(255,0,0,0); }
            50% { background-color: rgba(255,0,0,0.3); }
            100% { background-color: rgba(255,0,0,0); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .screen {
            display: none;
            min-height: 80vh;
        }

        .screen.active {
            display: block;
        }

        .title {
            text-align: center;
            font-size: 2.5em;
            color: #FFCC00;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .subtitle {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 30px;
        }

        .setup-container {
            text-align: center;
            padding: 40px;
        }

        .player-count-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .count-btn {
            padding: 15px 25px;
            font-size: 1.5em;
            border: 3px solid #FFCC00;
            background: transparent;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
        }

        .count-btn.selected, .count-btn:hover {
            background: #FFCC00;
            color: black;
        }

        .input-section {
            margin: 30px 0;
        }

        .player-input {
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #FFCC00;
            border-radius: 5px;
            margin: 10px;
            text-align: center;
        }

        .player-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }

        .color-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .current-player {
            font-size: 1.2em;
            padding: 10px 20px;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
        }

        .scoreboard {
            background: rgba(255,255,255,0.9);
            color: black;
            padding: 20px;
            border-radius: 10px;
            min-width: 250px;
        }

        .player-score {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 8px;
            border-radius: 5px;
        }

        .player-score.active {
            background: #FFCC00;
        }

        .board-container {
            display: flex;
            gap: 20px;
        }

        .game-board {
            flex: 1;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }

        .category-header {
            background: #FFCC00;
            color: black;
            padding: 15px 5px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9em;
            border: 2px solid black;
        }

        .amounts-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .amount-btn {
            background: #060CE9;
            color: #FFCC00;
            border: 2px solid black;
            padding: 20px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .amount-btn:hover {
            background: #FFCC00;
            color: black;
        }

        .amount-btn.used {
            background: #666;
            color: #333;
            cursor: not-allowed;
        }

        .question-container {
            display: flex;
            gap: 20px;
        }

        .question-main {
            flex: 1;
        }

        .question-header {
            margin-bottom: 20px;
        }

        .answer-box, .question-box {
            background: white;
            color: black;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 3px solid black;
        }

        .question-box {
            background: #FFCC00;
        }

        .answer-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .player-btn {
            padding: 10px;
            border: 2px solid black;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .player-btn:hover {
            transform: scale(1.05);
        }

        .final-jeopardy {
            text-align: center;
            padding: 40px;
        }

        .wager-input {
            padding: 15px;
            font-size: 1.5em;
            text-align: center;
            border: 3px solid #FFCC00;
            border-radius: 10px;
            margin: 20px;
        }

        .wager-info {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .results {
            text-align: center;
            padding: 40px;
        }

        .winner {
            font-size: 2em;
            color: #FFCC00;
            margin: 30px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .final-scores {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            margin: 30px auto;
            max-width: 500px;
        }

        .score-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
        }

        .btn-primary {
            background: #FFCC00;
            color: black;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .categories, .amounts-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .board-container {
                flex-direction: column;
            }
            
            .answer-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Audio Controls -->
        <div class="audio-controls">
            <button class="audio-btn" id="music-toggle">🎵 Music</button>
            <button class="audio-btn" id="sfx-toggle">🔊 SFX</button>
            <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="50">
            <span style="font-size: 0.8em; color: white;">Vol</span>
        </div>

        <!-- Hidden Audio Elements -->
        <audio id="theme-music" loop>
            <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBkOa2e+3dCUB" type="audio/wav">
        </audio>

        <audio id="question-select">
            <source src="data:audio/wav;base64,UklGRpYBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YXIBAADCw8PDxMLCwkRFRERFREQBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE=" type="audio/wav">
        </audio>

        <audio id="correct-sound">
            <source src="data:audio/wav;base64,UklGRlwBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YTgBAABjZGNkY2RjZJiZmJmYmZiZ/v7+/v7+/v7+AP8A/wD/AP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=" type="audio/wav">
        </audio>

        <audio id="incorrect-sound">
            <source src="data:audio/wav;base64,UklGRhwBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YfgAAACRkZGRkZGRkR8fHx8fHx8fAgICAgICAgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=" type="audio/wav">
        </audio>

        <audio id="final-jeopardy-music" loop>
            <source src="data:audio/wav;base64,UklGRmoBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YUYBAAAxMTExMTExMf7+/v7+/v7+MjIyMjIyMjL9/f39/f39/TMzMzMzMzMz/Pz8/Pz8/Pz0AAAA9PT09PT09PT19fX19fX19fQAAAD09PT09PT09PT19fX19fX19fQAAAD09PT09PT09PT19fX19fX19fQAAAD09PT09PT09PT19fX19fX19fQAAAD09PT09PT09PT19fX19fX19fQAAAD09PT09PT09A==" type="audio/wav">
        </audio>

        <audio id="buzzer-sound">
            <source src="data:audio/wav;base64,UklGRqYBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YYIBAACoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKio=" type="audio/wav">
        </audio>

        <audio id="applause-sound">
            <source src="data:audio/wav;base64,UklGRvYBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YdIBAAD+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+" type="audio/wav">
        </audio>
        <!-- Main Menu Screen -->
        <div id="main-menu-screen" class="screen active">
            <div class="setup-container">
                <h1 class="title">AEROSPACE ETHICS JEOPARDY</h1>
                <p class="subtitle">✈️ 🛩️ ✈️</p>
                
                <div style="margin: 40px 0;">
                    <h2>Choose Game Mode:</h2>
                    <button class="btn btn-primary" id="play-default-btn" style="margin: 10px; padding: 20px 40px;">
                        PLAY WITH DEFAULT QUESTIONS
                    </button>
                    <br>
                    <button class="btn btn-success" id="create-questions-btn" style="margin: 10px; padding: 20px 40px;">
                        CREATE CUSTOM QUESTIONS
                    </button>
                    <br>
                    <button class="btn" id="play-custom-btn" style="margin: 10px; padding: 20px 40px; background: #FF8C00; color: white;">
                        PLAY WITH CUSTOM QUESTIONS
                    </button>
                </div>

                <div style="margin-top: 40px; font-size: 0.9em; color: #CCCCCC;">
                    <p><strong>Default:</strong> 25 pre-made Aerospace Ethics questions</p>
                    <p><strong>Custom:</strong> Create your own questions for any subject!</p>
                </div>
            </div>
        </div>

        <!-- Question Creator Screen -->
        <div id="creator-screen" class="screen">
            <div class="setup-container">
                <h1 class="title">CREATE CUSTOM QUESTIONS</h1>
                <p class="subtitle">Build your own Jeopardy game!</p>
                
                <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px; margin: 20px 0;">
                    <h3>Question <span id="question-counter">1</span> of 25</h3>
                    <p>Category: <span id="current-category-display">Category 1</span> - $<span id="current-amount-display">100</span></p>
                    
                    <div style="margin: 20px 0;">
                        <label style="display: block; font-weight: bold; margin-bottom: 10px; color: #FFCC00;">
                            Category Name (optional - rename "Category 1"):
                        </label>
                        <input type="text" id="category-name-input" style="width: 100%; padding: 12px; border: 2px solid #FFCC00; border-radius: 5px; font-size: 1em;" placeholder="e.g., History, Science, Sports...">
                    </div>

                    <div style="margin: 20px 0;">
                        <label style="display: block; font-weight: bold; margin-bottom: 10px; color: #FFCC00;">
                            Answer (what contestants will see):
                        </label>
                        <textarea id="answer-input" style="width: 100%; height: 100px; padding: 12px; border: 2px solid #FFCC00; border-radius: 5px; font-size: 1em; resize: vertical;" placeholder="Enter the clue/answer that contestants will read..."></textarea>
                    </div>

                    <div style="margin: 20px 0;">
                        <label style="display: block; font-weight: bold; margin-bottom: 10px; color: #FFCC00;">
                            Correct Question (what they should respond with):
                        </label>
                        <textarea id="question-input" style="width: 100%; height: 100px; padding: 12px; border: 2px solid #FFCC00; border-radius: 5px; font-size: 1em; resize: vertical;" placeholder="Enter the correct question response (usually starts with 'What is...' or 'Who is...')"></textarea>
                    </div>

                    <div style="text-align: center; margin: 30px 0;">
                        <button class="btn btn-success" id="save-question-btn">SAVE & NEXT QUESTION</button>
                        <button class="btn" id="skip-question-btn" style="background: #FFA500; color: white;">SKIP THIS QUESTION</button>
                    </div>

                    <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; margin: 20px 0;">
                        <h4>Progress:</h4>
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 10px;">
                            <div style="text-align: center;">
                                <div style="font-weight: bold; color: #FFCC00;">Cat 1</div>
                                <div id="progress-cat1">0/5</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: bold; color: #FFCC00;">Cat 2</div>
                                <div id="progress-cat2">0/5</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: bold; color: #FFCC00;">Cat 3</div>
                                <div id="progress-cat3">0/5</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: bold; color: #FFCC00;">Cat 4</div>
                                <div id="progress-cat4">0/5</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: bold; color: #FFCC00;">Cat 5</div>
                                <div id="progress-cat5">0/5</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-primary" id="back-to-menu-btn">BACK TO MENU</button>
                    <button class="btn btn-success" id="finish-creating-btn">FINISH & PLAY GAME</button>
                </div>
            </div>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="screen">
            <div class="setup-container">
                <h1 class="title">GAME SETUP</h1>
                
                <div id="player-count-section">
                    <h2>How many players? (2-5)</h2>
                    <div class="player-count-buttons">
                        <button class="count-btn" data-count="2">2</button>
                        <button class="count-btn" data-count="3">3</button>
                        <button class="count-btn selected" data-count="4">4</button>
                        <button class="count-btn" data-count="5">5</button>
                    </div>
                    <button class="btn btn-primary" id="continue-btn">Continue</button>
                </div>

                <div id="name-entry-section" class="hidden">
                    <h2 id="name-prompt">Enter name for Player 1:</h2>
                    <div class="player-preview">
                        <div id="current-color" class="color-indicator"></div>
                        <input type="text" id="player-name-input" class="player-input" maxlength="15" placeholder="Enter player name">
                    </div>
                    <button class="btn btn-success" id="add-player-btn">Next Player</button>
                </div>

                <div id="players-summary" class="hidden">
                    <h2>Players:</h2>
                    <div id="players-list"></div>
                    <button class="btn btn-primary" id="start-game-btn">START GAME</button>
                </div>
            </div>
        </div>

        <!-- Game Board Screen -->
        <div id="board-screen" class="screen">
            <div class="game-header">
                <div>
                    <h1 class="title">AEROSPACE ETHICS JEOPARDY</h1>
                    <div id="current-turn" class="current-player"></div>
                </div>
                <div class="scoreboard">
                    <h3>PLAYERS</h3>
                    <div id="scoreboard-content"></div>
                </div>
            </div>

            <div class="board-container">
                <div class="game-board">
                    <div class="categories">
                        <div class="category-header">COST-CUTTING</div>
                        <div class="category-header">ETHICAL THEMES</div>
                        <div class="category-header">REGULATIONS</div>
                        <div class="category-header">AVIATION INDUSTRY</div>
                        <div class="category-header">SAFETY CULTURE</div>
                    </div>
                    <div class="amounts-grid" id="amounts-grid"></div>
                    <p style="margin-top: 20px;">Questions remaining: <span id="questions-remaining">25</span></p>
                </div>
            </div>
        </div>

        <!-- Question Screen -->
        <div id="question-screen" class="screen">
            <div class="question-container">
                <div class="question-main">
                    <div class="question-header">
                        <h1 class="title">AEROSPACE ETHICS JEOPARDY</h1>
                        <h2 id="question-category"></h2>
                        <h3 id="question-value"></h3>
                        <p id="question-selector"></p>
                    </div>

                    <div class="answer-box">
                        <h3>ANSWER:</h3>
                        <p id="answer-text"></p>
                    </div>

                    <div id="show-question-section">
                        <button class="btn btn-primary" id="show-question-btn">SHOW CORRECT QUESTION</button>
                    </div>

                    <div id="question-section" class="hidden">
                        <div class="question-box">
                            <h3>CORRECT QUESTION:</h3>
                            <p id="question-text"></p>
                        </div>

                        <h3>Who answered correctly?</h3>
                        <div class="answer-buttons" id="answer-buttons"></div>
                        <button class="btn btn-danger" id="nobody-correct-btn">NOBODY CORRECT</button>
                    </div>
                </div>
                <div class="scoreboard">
                    <h3>PLAYERS</h3>
                    <div id="question-scoreboard"></div>
                </div>
            </div>
        </div>

        <!-- Final Jeopardy Wager Screen -->
        <div id="final-wager-screen" class="screen">
            <div class="final-jeopardy">
                <h1 class="title">FINAL JEOPARDY - WAGERING</h1>
                <div id="current-wagerer"></div>
                <div class="wager-info">
                    <p id="current-score"></p>
                    <p id="max-wager"></p>
                </div>
                <input type="number" id="wager-input" class="wager-input" placeholder="Enter wager amount" min="0">
                <br>
                <button class="btn btn-primary" id="submit-wager-btn">SUBMIT WAGER</button>
                <div id="previous-wagers"></div>
            </div>
        </div>

        <!-- Final Jeopardy Question Screen -->
        <div id="final-question-screen" class="screen">
            <div class="final-jeopardy">
                <h1 class="title">FINAL JEOPARDY!</h1>
                <h2>Category: AVIATION ETHICS PHILOSOPHY</h2>
                
                <div class="answer-box">
                    <h3>ANSWER:</h3>
                    <p>This concept suggests that professional codes provide rules for circumstances without regulatory backing, but require consistent management behavior modeling for long-term effectiveness in transitioning decision-makers to higher ethical levels.</p>
                </div>

                <div id="final-show-section">
                    <button class="btn btn-primary" id="show-final-question-btn">SHOW CORRECT QUESTION</button>
                </div>

                <div id="final-question-section" class="hidden">
                    <div class="question-box">
                        <h3>CORRECT QUESTION:</h3>
                        <p>What is the fundamental purpose and limitation of professional codes of ethics in aviation?</p>
                    </div>

                    <h3>Who answered correctly?</h3>
                    <div class="answer-buttons" id="final-answer-buttons"></div>
                    <button class="btn btn-success" id="finish-game-btn">FINISH GAME</button>
                </div>

                <div class="wager-info">
                    <h3>Player Wagers:</h3>
                    <div id="all-wagers"></div>
                </div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="screen">
            <div class="results">
                <h1 class="title">FINAL RESULTS!</h1>
                <div id="winner-announcement" class="winner"></div>
                <div class="final-scores">
                    <h2>FINAL SCORES:</h2>
                    <div id="final-rankings"></div>
                </div>
                <p>Questions Answered: <span id="final-question-count">25</span>/25</p>
                <button class="btn btn-success" id="play-again-btn">PLAY AGAIN</button>
                <button class="btn btn-danger" id="quit-game-btn">QUIT</button>
            </div>
        </div>
    </div>

    <script>
        // Game Data - Aerospace Ethics Questions
        const gameData = {
            "COST-CUTTING": {
                100: {
                    answer: "These seven measures include outsourcing maintenance, leasing aircraft, offering ticket-less travel, using kiosk-based check-in, minimizing inflight meals, transferring functions to call centers, and maximizing employee scheduling efficiency.",
                    question: "What are the 7 typical airline cost-cutting measures?",
                    used: false
                },
                200: {
                    answer: "Airlines now lease new airplanes for shorter periods, increased aircraft reliability has reduced maintenance needs, computer technology has transformed maintenance into 'remove and replace' rather than repair, and lay-offs have forced maintenance professionals to seek employment outside aviation.",
                    question: "What are the 4 maintenance changes that have occurred to reduce cost?",
                    used: false
                },
                300: {
                    answer: "This describes mechanics who love the technology and their work but feel undervalued by their company, creating a disconnect between labor and management groups.",
                    question: "What does 'square peg in a round hole' mean in aviation maintenance?",
                    used: false
                },
                400: {
                    answer: "This collaborative program between management, labor, and regulators detects and resolves systemic problems through self-reports of maintenance errors.",
                    question: "What is the ASAP program?",
                    used: false
                },
                500: {
                    answer: "Only two universities offered aviation ethics courses at the time of writing, and while students found them interesting, they didn't necessarily teach 'anything new'.",
                    question: "What is the status of ethics education in collegiate aviation programs?",
                    used: false
                }
            },
            "ETHICAL THEMES": {
                100: {
                    answer: "These four themes are: passion for aviation, commitment to safety, role models and defining moments, and square peg in a round hole.",
                    question: "What are the four themes that emerged from interviewing mechanics and inspectors?",
                    used: false
                },
                200: {
                    answer: "Most people in aviation are passionate about airplanes, fascinated by flight technology, and willing to endure incredible highs and lows professionally and personally.",
                    question: "What characterizes 'passion for aviation' as described in Chapter 3?",
                    used: false
                },
                300: {
                    answer: "Maintenance personnel are committed to safety because they've incurred personal injury, been proximal to accidents, were influenced by role models, or were mentored early in their careers.",
                    question: "What motivates maintenance personnel's commitment to safety?",
                    used: false
                },
                400: {
                    answer: "These are important elements of character development, where both positive and negative examples impact impressionable minds.",
                    question: "What are role models and defining moments in professional development?",
                    used: false
                },
                500: {
                    answer: "Military training emphasizes thoroughness, attention to detail, following procedures exactly, accountability for tools and actions, and systematic approaches to maintenance.",
                    question: "What military work practices might help improve safety in civilian aviation?",
                    used: false
                }
            },
            "REGULATIONS": {
                100: {
                    answer: "This is the process by which individuals learn appropriate behaviors by observing and imitating the actions of others, particularly authority figures.",
                    question: "What is behavior modeling?",
                    used: false
                },
                200: {
                    answer: "Their function is to create, enforce, and oversee compliance with aviation safety regulations and ensure public safety through inspections and oversight.",
                    question: "What is the function of Federal Regulators?",
                    used: false
                },
                300: {
                    answer: "They develop, publicize, and uphold high ethical standards; create codes of ethics; provide guidance to membership; and help transition individuals from Level-1 to Level-2 decision-makers.",
                    question: "What are the responsibilities of Professional Organizations in the aviation industry?",
                    used: false
                },
                400: {
                    answer: "An AMT is responsible for public safety, will exercise good judgment in evaluating risks, and will not degrade their profession by allowing supervisors to persuade them against better judgment.",
                    question: "What are the 3 Code of Ethics published by PAMA?",
                    used: false
                },
                500: {
                    answer: "Ethical behavior builds trust because it demonstrates reliability, integrity, and consistency in decision-making, essential for professional relationships and public confidence.",
                    question: "Why is the practice of ethical behavior associated with trust?",
                    used: false
                }
            },
            "AVIATION INDUSTRY": {
                100: {
                    answer: "The post-deregulation aviation industry has been plagued with fare wars, with very few airlines successful in the low-cost business model.",
                    question: "What characterizes the modern aviation industry environment?",
                    used: false
                },
                200: {
                    answer: "Outsourcing maintenance, leasing aircraft instead of buying, offering ticket-less travel, using kiosk-based check-in, and minimizing costs wherever possible.",
                    question: "What are typical cost-cutting measures airlines use?",
                    used: false
                },
                300: {
                    answer: "The drive to reduce costs and increased equipment reliability have pushed safety concerns into the design domain, leading toward 'disposable' consumerism.",
                    question: "How have cost-cutting measures affected aviation safety philosophy?",
                    used: false
                },
                400: {
                    answer: "Historical stigma, classification as 'semi-skilled' laborers, limited collegiate education, and reluctance to take charge due to seeing themselves as 'not the management type'.",
                    question: "What factors prevent mechanics from taking leadership roles?",
                    used: false
                },
                500: {
                    answer: "Companies focus on survival and getting paperwork signed off rather than whether jobs are done properly, leading to outsourcing and reduced investment in employee development.",
                    question: "What are the current trends affecting aviation maintenance quality?",
                    used: false
                }
            },
            "SAFETY CULTURE": {
                100: {
                    answer: "Safety should always be on the forefront of your mind, and safety ethics should be enforced to the extent that they become part of company culture.",
                    question: "What is the fundamental principle of aviation safety culture?",
                    used: false
                },
                200: {
                    answer: "Personal injury, proximity to serious accidents, influence of powerful role models, early career mentoring, or genuine love for aviation and recognition of responsibilities.",
                    question: "What experiences lead to strong commitment to safety?",
                    used: false
                },
                300: {
                    answer: "People working midnights affects safety because fatigue leads to poor decision-making, increased mistakes, and reduced alertness during critical maintenance tasks.",
                    question: "How do work schedules like midnight shifts impact aviation safety?",
                    used: false
                },
                400: {
                    answer: "It creates a system where mechanics feel pressure to rush work, compromise quality, and focus on paperwork completion rather than thorough maintenance.",
                    question: "How does the current aviation business model affect maintenance ethics?",
                    used: false
                },
                500: {
                    answer: "A code of ethics provides opportunity for Level-1 decision-makers to move toward Level-2 decision-making, but requires consistent behavior modeling by management for effectiveness.",
                    question: "What is the fundamental purpose and limitation of professional codes of ethics?",
                    used: false
                }
            }
        };

        // Game State
        let gameState = {
            players: [],
            currentPlayer: 0,
            questionSelector: 0,
            questionsAnswered: 0,
            totalQuestions: 25,
            numPlayers: 4,
            setupStep: 0,
            currentQuestion: null,
            currentCategory: null,
            currentAmount: 0,
            finalJeopardyPlayer: 0,
            usingCustomQuestions: false,
            creatorStep: 0,
            creatorCategory: 1,
            creatorAmount: 100
        };

        // Custom Questions Storage
        let customQuestions = {
            categories: ['Category 1', 'Category 2', 'Category 3', 'Category 4', 'Category 5'],
            questions: {
                1: { 100: null, 200: null, 300: null, 400: null, 500: null },
                2: { 100: null, 200: null, 300: null, 400: null, 500: null },
                3: { 100: null, 200: null, 300: null, 400: null, 500: null },
                4: { 100: null, 200: null, 300: null, 400: null, 500: null },
                5: { 100: null, 200: null, 300: null, 400: null, 500: null }
            }
        };

        const playerColors = [
            '#FF6464', '#64FF64', '#6464FF', '#FFFF64', '#FF64FF'
        ];

        // Audio Management
        class AudioManager {
            constructor() {
                this.musicEnabled = true;
                this.sfxEnabled = true;
                this.volume = 0.5;
                
                this.themeMusic = document.getElementById('theme-music');
                this.questionSelect = document.getElementById('question-select');
                this.correctSound = document.getElementById('correct-sound');
                this.incorrectSound = document.getElementById('incorrect-sound');
                this.finalJeopardyMusic = document.getElementById('final-jeopardy-music');
                this.buzzerSound = document.getElementById('buzzer-sound');
                this.applauseSound = document.getElementById('applause-sound');
                
                this.setVolume(this.volume);
                this.setupControls();
            }
            
            setupControls() {
                const musicToggle = document.getElementById('music-toggle');
                const sfxToggle = document.getElementById('sfx-toggle');
                const volumeSlider = document.getElementById('volume-slider');
                
                musicToggle.addEventListener('click', () => this.toggleMusic());
                sfxToggle.addEventListener('click', () => this.toggleSFX());
                volumeSlider.addEventListener('input', (e) => this.setVolume(e.target.value / 100));
            }
            
            toggleMusic() {
                this.musicEnabled = !this.musicEnabled;
                const btn = document.getElementById('music-toggle');
                
                if (this.musicEnabled) {
                    btn.classList.remove('muted');
                    btn.textContent = '🎵 Music';
                } else {
                    btn.classList.add('muted');
                    btn.textContent = '🔇 Music';
                    this.stopMusic();
                }
            }
            
            toggleSFX() {
                this.sfxEnabled = !this.sfxEnabled;
                const btn = document.getElementById('sfx-toggle');
                
                if (this.sfxEnabled) {
                    btn.classList.remove('muted');
                    btn.textContent = '🔊 SFX';
                } else {
                    btn.classList.add('muted');
                    btn.textContent = '🔇 SFX';
                }
            }
            
            setVolume(volume) {
                this.volume = volume;
                const allAudio = [this.themeMusic, this.questionSelect, this.correctSound, 
                                this.incorrectSound, this.finalJeopardyMusic, this.buzzerSound, this.applauseSound];
                
                allAudio.forEach(audio => {
                    if (audio) audio.volume = volume;
                });
            }
            
            playThemeMusic() {
                if (this.musicEnabled && this.themeMusic) {
                    this.themeMusic.currentTime = 0;
                    this.themeMusic.play().catch(() => {});
                }
            }
            
            stopMusic() {
                if (this.themeMusic) this.themeMusic.pause();
                if (this.finalJeopardyMusic) this.finalJeopardyMusic.pause();
            }
            
            playQuestionSelect() {
                if (this.sfxEnabled && this.questionSelect) {
                    this.questionSelect.currentTime = 0;
                    this.questionSelect.play().catch(() => {});
                }
            }
            
            playCorrect() {
                if (this.sfxEnabled && this.correctSound) {
                    this.correctSound.currentTime = 0;
                    this.correctSound.play().catch(() => {});
                }
            }
            
            playIncorrect() {
                if (this.sfxEnabled && this.incorrectSound) {
                    this.incorrectSound.currentTime = 0;
                    this.incorrectSound.play().catch(() => {});
                }
            }
            
            playFinalJeopardy() {
                if (this.musicEnabled && this.finalJeopardyMusic) {
                    this.stopMusic();
                    this.finalJeopardyMusic.currentTime = 0;
                    this.finalJeopardyMusic.play().catch(() => {});
                }
            }
            
            playBuzzer() {
                if (this.sfxEnabled && this.buzzerSound) {
                    this.buzzerSound.currentTime = 0;
                    this.buzzerSound.play().catch(() => {});
                }
            }
            
            playApplause() {
                if (this.sfxEnabled && this.applauseSound) {
                    this.applauseSound.currentTime = 0;
                    this.applauseSound.play().catch(() => {});
                }
            }
        }

        // Initialize audio manager
        let audioManager;

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Main menu
            document.getElementById('play-default-btn').addEventListener('click', function() {
                gameState.usingCustomQuestions = false;
                showScreen('setup-screen');
            });

            document.getElementById('create-questions-btn').addEventListener('click', function() {
                showScreen('creator-screen');
                initializeCreator();
            });

            document.getElementById('play-custom-btn').addEventListener('click', function() {
                if (isCustomGameComplete()) {
                    gameState.usingCustomQuestions = true;
                    showScreen('setup-screen');
                } else {
                    alert('Please create all 25 custom questions first!');
                }
            });

            // Question Creator
            document.getElementById('save-question-btn').addEventListener('click', saveCurrentQuestion);
            document.getElementById('skip-question-btn').addEventListener('click', skipCurrentQuestion);
            document.getElementById('back-to-menu-btn').addEventListener('click', function() {
                showScreen('main-menu-screen');
            });
            document.getElementById('finish-creating-btn').addEventListener('click', function() {
                if (isCustomGameComplete()) {
                    gameState.usingCustomQuestions = true;
                    showScreen('setup-screen');
                } else {
                    alert('Please complete all 25 questions before playing!');
                }
            });

            // Player count selection
            document.querySelectorAll('.count-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    gameState.numPlayers = parseInt(this.dataset.count);
                    document.querySelectorAll('.count-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });

            // Setup buttons
            document.getElementById('continue-btn').addEventListener('click', startNameEntry);
            document.getElementById('add-player-btn').addEventListener('click', addPlayer);
            document.getElementById('start-game-btn').addEventListener('click', startGame);

            // Question screen buttons
            document.getElementById('show-question-btn').addEventListener('click', showQuestion);
            document.getElementById('nobody-correct-btn').addEventListener('click', nobodyCorrect);

            // Final Jeopardy buttons
            document.getElementById('submit-wager-btn').addEventListener('click', submitWager);
            document.getElementById('show-final-question-btn').addEventListener('click', showFinalQuestion);
            document.getElementById('finish-game-btn').addEventListener('click', finishGame);

            // Game over buttons
            document.getElementById('play-again-btn').addEventListener('click', playAgain);
            document.getElementById('quit-game-btn').addEventListener('click', quitGame);

            // Keyboard events
            document.getElementById('player-name-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addPlayer();
                }
            });

            document.getElementById('wager-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    submitWager();
                }
            });

            console.log('🛩️ Custom Jeopardy Game Loaded! ✈️');
        });

        // Question Creator Functions
        function initializeCreator() {
            gameState.creatorStep = 0;
            gameState.creatorCategory = 1;
            gameState.creatorAmount = 100;
            updateCreatorDisplay();
        }

        function updateCreatorDisplay() {
            const stepNumber = gameState.creatorStep + 1;
            const categoryName = customQuestions.categories[gameState.creatorCategory - 1];
            
            document.getElementById('question-counter').textContent = stepNumber;
            document.getElementById('current-category-display').textContent = categoryName;
            document.getElementById('current-amount-display').textContent = gameState.creatorAmount;
            
            // Clear inputs
            document.getElementById('category-name-input').value = '';
            document.getElementById('answer-input').value = '';
            document.getElementById('question-input').value = '';
            
            // Update progress display
            updateProgressDisplay();
            
            // Focus on first input
            document.getElementById('answer-input').focus();
        }

        function updateProgressDisplay() {
            for (let cat = 1; cat <= 5; cat++) {
                let completed = 0;
                for (let amount of [100, 200, 300, 400, 500]) {
                    if (customQuestions.questions[cat][amount]) {
                        completed++;
                    }
                }
                document.getElementById(`progress-cat${cat}`).textContent = `${completed}/5`;
            }
        }

        function saveCurrentQuestion() {
            const categoryName = document.getElementById('category-name-input').value.trim();
            const answer = document.getElementById('answer-input').value.trim();
            const question = document.getElementById('question-input').value.trim();
            
            if (!answer || !question) {
                alert('Please fill in both the answer and question fields!');
                return;
            }
            
            // Update category name if provided
            if (categoryName) {
                customQuestions.categories[gameState.creatorCategory - 1] = categoryName;
            }
            
            // Save the question
            customQuestions.questions[gameState.creatorCategory][gameState.creatorAmount] = {
                answer: answer,
                question: question,
                used: false
            };
            
            // Move to next question
            nextCreatorStep();
        }

        function skipCurrentQuestion() {
            // Just move to next without saving
            nextCreatorStep();
        }

        function nextCreatorStep() {
            gameState.creatorStep++;
            
            // Move to next amount
            if (gameState.creatorAmount < 500) {
                gameState.creatorAmount += 100;
            } else {
                // Move to next category
                gameState.creatorAmount = 100;
                gameState.creatorCategory++;
            }
            
            // Check if we're done
            if (gameState.creatorStep >= 25) {
                alert('All questions created! You can now play your custom game.');
                showScreen('main-menu-screen');
            } else {
                updateCreatorDisplay();
            }
        }

        function isCustomGameComplete() {
            let totalQuestions = 0;
            for (let cat = 1; cat <= 5; cat++) {
                for (let amount of [100, 200, 300, 400, 500]) {
                    if (customQuestions.questions[cat][amount]) {
                        totalQuestions++;
                    }
                }
            }
            return totalQuestions === 25;
        }

        function getGameData() {
            if (gameState.usingCustomQuestions) {
                // Convert custom questions to game format
                const customGameData = {};
                for (let cat = 1; cat <= 5; cat++) {
                    const categoryName = customQuestions.categories[cat - 1];
                    customGameData[categoryName] = {};
                    for (let amount of [100, 200, 300, 400, 500]) {
                        if (customQuestions.questions[cat][amount]) {
                            customGameData[categoryName][amount] = customQuestions.questions[cat][amount];
                        } else {
                            // Placeholder for missing questions
                            customGameData[categoryName][amount] = {
                                answer: "Question not created",
                                question: "What is a missing question?",
                                used: false
                            };
                        }
                    }
                }
                return customGameData;
            } else {
                return gameData;
            }
        }

        // Utility Functions
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // Setup Functions
        function startNameEntry() {
            document.getElementById('player-count-section').classList.add('hidden');
            document.getElementById('name-entry-section').classList.remove('hidden');
            gameState.setupStep = 1;
            updateNameEntry();
        }

        function updateNameEntry() {
            const playerNum = gameState.players.length + 1;
            document.getElementById('name-prompt').textContent = `Enter name for Player ${playerNum}:`;
            document.getElementById('current-color').style.backgroundColor = playerColors[gameState.players.length];
            document.getElementById('player-name-input').value = '';
            document.getElementById('player-name-input').focus();
        }

        function addPlayer() {
            const nameInput = document.getElementById('player-name-input');
            const name = nameInput.value.trim();
            
            if (name) {
                gameState.players.push({
                    name: name,
                    score: 0,
                    color: playerColors[gameState.players.length],
                    finalJeopardyWager: 0,
                    hasWagered: false
                });

                if (gameState.players.length < gameState.numPlayers) {
                    updateNameEntry();
                } else {
                    showPlayersSummary();
                }
            }
        }

        function showPlayersSummary() {
            document.getElementById('name-entry-section').classList.add('hidden');
            document.getElementById('players-summary').classList.remove('hidden');
            
            const playersList = document.getElementById('players-list');
            playersList.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-preview';
                playerDiv.innerHTML = `
                    <div class="color-indicator" style="background-color: ${player.color}"></div>
                    <span>${index + 1}. ${player.name}</span>
                `;
                playersList.appendChild(playerDiv);
            });
        }

        // Game Functions
        function startGame() {
            showScreen('board-screen');
            initializeBoard();
            updateScoreboard();
            updateCurrentTurn();
        }

        function initializeBoard() {
            const amountsGrid = document.getElementById('amounts-grid');
            amountsGrid.innerHTML = '';
            
            const categories = Object.keys(gameData);
            const amounts = [100, 200, 300, 400, 500];
            
            amounts.forEach(amount => {
                categories.forEach(category => {
                    const btn = document.createElement('button');
                    btn.className = 'amount-btn';
                    btn.textContent = `$${amount}`;
                    btn.addEventListener('click', () => selectQuestion(category, amount));
                    btn.id = `${category}-${amount}`;
                    amountsGrid.appendChild(btn);
                });
            });
        }

        function selectQuestion(category, amount) {
            if (gameData[category][amount].used) return;
            
            gameState.currentCategory = category;
            gameState.currentAmount = amount;
            gameState.currentQuestion = gameData[category][amount];
            
            showScreen('question-screen');
            displayQuestion();
        }

        function displayQuestion() {
            document.getElementById('question-category').textContent = `Category: ${gameState.currentCategory}`;
            document.getElementById('question-value').textContent = `Value: $${gameState.currentAmount}`;
            document.getElementById('question-selector').textContent = `Selected by: ${gameState.players[gameState.questionSelector].name}`;
            document.getElementById('answer-text').textContent = gameState.currentQuestion.answer;
            
            document.getElementById('show-question-section').classList.remove('hidden');
            document.getElementById('question-section').classList.add('hidden');
            
            updateQuestionScoreboard();
        }

        function showQuestion() {
            document.getElementById('show-question-section').classList.add('hidden');
            document.getElementById('question-section').classList.remove('hidden');
            document.getElementById('question-text').textContent = gameState.currentQuestion.question;
            
            const answerButtons = document.getElementById('answer-buttons');
            answerButtons.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const btn = document.createElement('button');
                btn.className = 'player-btn';
                btn.style.backgroundColor = player.color;
                btn.style.color = 'black';
                btn.textContent = `${player.name} ✓`;
                btn.addEventListener('click', () => playerCorrect(index));
                answerButtons.appendChild(btn);
            });
        }

        function playerCorrect(playerIndex) {
            gameState.players[playerIndex].score += gameState.currentAmount;
            gameState.questionSelector = playerIndex;
            gameState.currentQuestion.used = true;
            gameState.questionsAnswered++;
            
            updateQuestionUsed();
            checkGameCompletion();
        }

        function nobodyCorrect() {
            gameState.currentQuestion.used = true;
            gameState.questionsAnswered++;
            
            updateQuestionUsed();
            checkGameCompletion();
        }

        function updateQuestionUsed() {
            const btn = document.getElementById(`${gameState.currentCategory}-${gameState.currentAmount}`);
            btn.classList.add('used');
            btn.textContent = '---';
            btn.onclick = null;
        }

        function checkGameCompletion() {
            if (gameState.questionsAnswered >= gameState.totalQuestions) {
                startFinalJeopardy();
            } else {
                showScreen('board-screen');
                updateScoreboard();
                updateCurrentTurn();
                updateQuestionsRemaining();
            }
        }

        // Final Jeopardy Functions
        function startFinalJeopardy() {
            gameState.finalJeopardyPlayer = 0;
            showScreen('final-wager-screen');
            updateWagerScreen();
        }

        function updateWagerScreen() {
            const currentPlayer = gameState.players[gameState.finalJeopardyPlayer];
            document.getElementById('current-wagerer').innerHTML = `
                <h2 style="color: ${currentPlayer.color}">${currentPlayer.name}'s turn to wager</h2>
            `;
            
            document.getElementById('current-score').textContent = `Current score: ${currentPlayer.score}`;
            const maxWager = Math.max(1000, currentPlayer.score);
            document.getElementById('max-wager').textContent = `Maximum wager: ${maxWager}`;
            document.getElementById('wager-input').max = maxWager;
            document.getElementById('wager-input').value = '';
            
            const previousWagers = document.getElementById('previous-wagers');
            previousWagers.innerHTML = '<h3>Wagers so far:</h3>';
            gameState.players.forEach(player => {
                if (player.hasWagered) {
                    const wagerDiv = document.createElement('div');
                    wagerDiv.style.color = player.color;
                    wagerDiv.textContent = `${player.name}: ${player.finalJeopardyWager}`;
                    previousWagers.appendChild(wagerDiv);
                }
            });
        }

        function submitWager() {
            const wagerInput = document.getElementById('wager-input');
            const wager = parseInt(wagerInput.value) || 0;
            const maxWager = Math.max(1000, gameState.players[gameState.finalJeopardyPlayer].score);
            
            if (wager >= 0 && wager <= maxWager) {
                gameState.players[gameState.finalJeopardyPlayer].finalJeopardyWager = wager;
                gameState.players[gameState.finalJeopardyPlayer].hasWagered = true;
                gameState.finalJeopardyPlayer++;
                
                if (gameState.finalJeopardyPlayer >= gameState.players.length) {
                    showFinalJeopardyQuestion();
                } else {
                    updateWagerScreen();
                }
            } else {
                alert(`Please enter a wager between $0 and ${maxWager}`);
            }
        }

        function showFinalJeopardyQuestion() {
            showScreen('final-question-screen');
            document.getElementById('final-show-section').classList.remove('hidden');
            document.getElementById('final-question-section').classList.add('hidden');
            
            const allWagers = document.getElementById('all-wagers');
            allWagers.innerHTML = '';
            gameState.players.forEach(player => {
                const wagerDiv = document.createElement('div');
                wagerDiv.style.color = player.color;
                wagerDiv.textContent = `${player.name}: ${player.finalJeopardyWager}`;
                allWagers.appendChild(wagerDiv);
            });
        }

        function showFinalQuestion() {
            document.getElementById('final-show-section').classList.add('hidden');
            document.getElementById('final-question-section').classList.remove('hidden');
            
            const finalAnswerButtons = document.getElementById('final-answer-buttons');
            finalAnswerButtons.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const btn = document.createElement('button');
                btn.className = 'player-btn';
                btn.style.backgroundColor = player.color;
                btn.style.color = 'black';
                btn.textContent = `${player.name} ✓`;
                btn.addEventListener('click', () => finalCorrect(index));
                finalAnswerButtons.appendChild(btn);
            });
        }

        function finalCorrect(playerIndex) {
            gameState.players[playerIndex].score += gameState.players[playerIndex].finalJeopardyWager;
            event.target.style.opacity = '0.5';
            event.target.onclick = null;
        }

        function finishGame() {
            showScreen('game-over-screen');
            displayResults();
        }

        // Game Over Functions
        function displayResults() {
            const sortedPlayers = [...gameState.players].sort((a, b) => b.score - a.score);
            
            const winner = sortedPlayers[0];
            document.getElementById('winner-announcement').innerHTML = `
                🏆 WINNER: <span style="color: ${winner.color}">${winner.name}</span>! 🏆
            `;
            
            const rankings = document.getElementById('final-rankings');
            rankings.innerHTML = '';
            
            sortedPlayers.forEach((player, index) => {
                const scoreItem = document.createElement('div');
                scoreItem.className = 'score-item';
                if (index === 0) {
                    scoreItem.style.backgroundColor = 'rgba(255, 204, 0, 0.3)';
                }
                
                scoreItem.innerHTML = `
                    <span>
                        <div class="color-indicator" style="background-color: ${player.color}; display: inline-block; margin-right: 10px;"></div>
                        ${index + 1}. ${player.name}
                    </span>
                    <span style="color: ${player.color}; font-weight: bold;">${player.score}</span>
                `;
                rankings.appendChild(scoreItem);
            });
            
            document.getElementById('final-question-count').textContent = gameState.questionsAnswered;
        }

        // Scoreboard Functions
        function updateScoreboard() {
            const scoreboardContent = document.getElementById('scoreboard-content');
            scoreboardContent.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const playerScore = document.createElement('div');
                playerScore.className = 'player-score';
                if (index === gameState.questionSelector) {
                    playerScore.classList.add('active');
                }
                
                playerScore.innerHTML = `
                    <div class="color-indicator" style="background-color: ${player.color}"></div>
                    <div>
                        <div style="font-weight: bold;">${player.name}</div>
                        <div>${player.score}</div>
                    </div>
                `;
                scoreboardContent.appendChild(playerScore);
            });
        }

        function updateQuestionScoreboard() {
            const questionScoreboard = document.getElementById('question-scoreboard');
            questionScoreboard.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const playerScore = document.createElement('div');
                playerScore.className = 'player-score';
                
                playerScore.innerHTML = `
                    <div class="color-indicator" style="background-color: ${player.color}"></div>
                    <div>
                        <div style="font-weight: bold;">${player.name}</div>
                        <div>${player.score}</div>
                    </div>
                `;
                questionScoreboard.appendChild(playerScore);
            });
        }

        function updateCurrentTurn() {
            const currentTurn = document.getElementById('current-turn');
            const player = gameState.players[gameState.questionSelector];
            currentTurn.innerHTML = `<span style="color: ${player.color}">${player.name}'s turn to select</span>`;
        }

        function updateQuestionsRemaining() {
            document.getElementById('questions-remaining').textContent = gameState.totalQuestions - gameState.questionsAnswered;
        }

        // Reset Functions
        function playAgain() {
            gameState = {
                players: [],
                currentPlayer: 0,
                questionSelector: 0,
                questionsAnswered: 0,
                totalQuestions: 25,
                numPlayers: 4,
                setupStep: 0,
                currentQuestion: null,
                currentCategory: null,
                currentAmount: 0,
                finalJeopardyPlayer: 0
            };
            
            Object.keys(gameData).forEach(category => {
                Object.keys(gameData[category]).forEach(amount => {
                    gameData[category][amount].used = false;
                });
            });
            
            document.getElementById('player-count-section').classList.remove('hidden');
            document.getElementById('name-entry-section').classList.add('hidden');
            document.getElementById('players-summary').classList.add('hidden');
            
            document.querySelectorAll('.count-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelectorAll('.count-btn')[2].classList.add('selected');
            
            showScreen('setup-screen');
        }

        function quitGame() {
            if (confirm('Are you sure you want to quit?')) {
                showScreen('main-menu-screen');
            }
        }
    </script>
</body>
</html>